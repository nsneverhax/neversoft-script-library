temp_net_id = [
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
	{
		net_id_first = 0
		net_id_second = 0
		name = qs(0x00000000)
		lefty_flip = 0
		mic_preference = none
		mic_type = none
		vocals_highway_view = scrolling
		character_id = gh_rocker_judy
		stored_character_index = 0
		character_savegame = -1
		double_kick = 0
		difficulty = medium
		part = none
		cheat_hyperspeed = 0
		cheat_hyperspeed_value = 1.0
		use_tilt_for_starpower = 1
		enable_touch_strip = 1
		solo_highway_mode = 0
		cheat_colorshuffle = 0
	}
]

script clear_temp_net_id_array 
	change \{temp_net_id = [
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
			{
				net_id_first = 0
				net_id_second = 0
				name = qs(0x00000000)
				lefty_flip = 0
				mic_preference = none
				mic_type = none
				vocals_highway_view = scrolling
				character_id = gh_rocker_judy
				stored_character_index = 0
				character_savegame = -1
				double_kick = 0
				difficulty = medium
				part = none
				cheat_hyperspeed = 0
				cheat_hyperspeed_value = 1.0
				use_tilt_for_starpower = 1
				enable_touch_strip = 1
				solo_highway_mode = 0
				cheat_colorshuffle = 0
			}
		]}
endscript

script setup_temp_net_id_array 
	getnumplayersingame \{local}
	if (<num_players> > 0)
		getfirstplayer \{local}
		begin
		set_player_temp_net_id_array player = <player>
		getnextplayer local player = <player>
		repeat <num_players>
	endif
endscript

script set_player_temp_net_id_array 
	requireparams \{[
			player
		]
		all}
	getplayerinfo <player> controller
	if netsessionfunc func = iscontrolleringame params = {controller = <controller>}
		getnetid controller_index = (<controller>)
		netsessionfunc func = get_gamertag params = {controller = <controller>}
		getplayerinfo <player> lefty_flip
		getplayerinfo <player> mic_type
		getplayerinfo <player> mic_preference
		getplayerinfo <player> character_savegame
		getplayerinfo <player> character_id
		getplayerinfo <player> double_kick_drum
		getplayerinfo <player> difficulty
		getplayerinfo <player> stored_character_index
		getplayerinfo <player> part
		getplayerinfo <player> cheat_hyperspeed
		getplayerinfo <player> cheat_hyperspeed_value
		getplayerinfo <player> vocals_highway_view
		getplayerinfo <player> enable_touch_strip
		getplayerinfo <player> use_tilt_for_starpower
		getplayerinfo <player> solo_highway_mode
		getplayerinfo <player> cheat_colorshuffle
		printf qs(0x03fc316c) d = <controller> h = <cheat_hyperspeed> v = <cheat_hyperspeed_value>
		setarrayelement {
			arrayname = temp_net_id
			globalarray
			index = <controller>
			newvalue = {
				net_id_first = <net_id_first>
				net_id_second = <net_id_second>
				name = <name>
				lefty_flip = <lefty_flip>
				mic_type = <mic_type>
				mic_preference = <mic_preference>
				character_savegame = <character_savegame>
				character_id = <character_id>
				stored_character_index = <stored_character_index>
				double_kick = <double_kick_drum>
				difficulty = <difficulty>
				part = <part>
				cheat_hyperspeed = <cheat_hyperspeed>
				cheat_hyperspeed_value = <cheat_hyperspeed_value>
				vocals_highway_view = <vocals_highway_view>
				enable_touch_strip = <enable_touch_strip>
				use_tilt_for_starpower = <use_tilt_for_starpower>
				solo_highway_mode = <solo_highway_mode>
				cheat_colorshuffle = <cheat_colorshuffle>
			}
		}
	endif
endscript

script net_party_save_off_invite_controllers 
	printf \{qs(0x6ce8d99e)}
	get_local_players_in_game
	getarraysize \{local_players}
	if (<array_size> > 0)
		i = 0
		begin
		if ((<local_players> [<i>]) = 1)
			getnetid controller_index = <i>
			netsessionfunc func = get_gamertag params = {controller = <i>}
			setarrayelement {
				globalarray
				arrayname = temp_net_id
				index = <i>
				newvalue = {
					net_id_first = <net_id_first>
					net_id_second = <net_id_second>
					name = <name>
				}
			}
		endif
		i = (<i> + 1)
		repeat <array_size>
	endif
endscript

script net_party_can_accept_new_players 
	printf \{qs(0x2334dcd0)}
	can_join = 1
	return can_join = <can_join>
endscript

script net_party_leave_current_game 
	printf \{qs(0x33bef1ce)}
	destroy_player_drop_events
	quit_network_game_early
	band_lobby_restore_prematchmaking_settings
	startrendering
	destroy_net_popup
	unpausegame
	gamemode_gettype
	if (quickplay = <type>)
		ui_event_get_stack
		if ('songlist' = (<stack> [0].base_name))
			generic_event_back \{state = uistate_band_lobby}
		elseif ('songlist' = (<stack> [1].base_name))
			if structurecontains structure = (<stack> [0]) is_popup
				generic_event_back \{state = uistate_band_lobby}
			else
				net_save_and_uistate_change \{event = menu_back
					state = uistate_band_lobby}
			endif
		else
			net_save_and_uistate_change \{event = menu_back
				state = uistate_band_lobby}
		endif
	elseif (career = <type>)
		if bl_is_in_band_lobby_menus
			change \{g_online_quit_refresh_band_lobby_hack = 1}
			change \{g_suppress_anim_in = 1}
			if screenelementexistssimpleid \{id = hud_mic_binding}
				hud_mic_binding :se_setprops \{block_events}
			endif
		endif
		band_lobby_change_focus_submenu_all \{focus_type = unfocus}
		if bl_is_in_band_lobby_menus
			begin
			if NOT savegame_async_is_busy
				break
			endif
			wait \{1
				gameframe}
			repeat
			begin
			if NOT scriptisrunning \{downloads_enumcontent}
				break
			endif
			wait \{1
				gameframe}
			repeat
		endif
		net_save_and_uistate_change \{event = menu_back
			state = uistate_band_lobby
			is_popup}
	else
		generic_event_back \{state = uistate_band_lobby}
	endif
endscript

script net_party_host_cancel_matchmaking 
	printf \{qs(0x5d5cc043)}
	if ($g_career_search = party_join)
		change \{g_career_search = null}
		band_lobby_return_from_matchmaking
		band_lobby_flash_ticker_msg \{msg_checksum = party_host_cancel_matchmake
			time = 6}
	endif
endscript

script net_party_host_started_matchmaking 
	printf \{qs(0xea82e4e2)}
	ui_event_get_top
	if gotparam \{is_popup}
		ui_event \{event = menu_back}
	endif
	if band_lobby_does_popup_exist
		band_lobby_destroy_popup_menu
	endif
	if gotparam \{game_mode}
		change game_mode = <game_mode>
		if (<game_mode> = career)
			change \{g_lobby_state = career}
		elseif (<game_mode> = quickplay)
			change \{g_lobby_state = quickplay}
		else
			change \{g_lobby_state = vs}
		endif
	endif
	if gotparam \{competitive_rules}
		change competitive_rules = <competitive_rules>
	endif
	if gotparam \{private}
		private = <private>
	else
		private = 0
	endif
	change \{g_career_search = party_join}
	printstruct <...>
	band_lobby_party_host_started_matchmaking private = <private>
endscript
g_net_party_needs_full_sync = 0

script net_party_attempted_join_result \{join_result = !i1768515945
		join_mode = quickplay_join}
	printf \{qs(0x781f28a3)}
	change \{has_invite_join_result_callback_completed = 1}
	if (<join_result> = 1)
		change \{g_lobby_enter_from_main_menu = 0}
		printf \{qs(0x9014f167)}
		if ($game_mode = freeplay)
			printf \{'net_party_attempted_join_result: SETTING GAME MODE TO CAREER'}
			change \{game_mode = career}
		endif
		if (<join_mode> = quickplay_join)
			change \{g_lobby_state = quickplay}
		elseif (<join_mode> = career_join)
			change \{g_lobby_state = career}
		elseif (<join_mode> = competitive_join)
			change \{g_lobby_state = vs}
		endif
		change \{g_lobby_net_state = net_private}
		netsessionfunc \{obj = party
			func = get_party_members}
		getarraysize \{connections}
		if (<array_size> > 0)
			<got_players> = 0
			begin
			netsessionfunc \{obj = party
				func = get_party_members}
			fastgetarraysize array = <connections>
			i = 0
			if (<array_size> > 0)
				begin
				if ((<connections> [<i>].is_local) = 1 && (<connections> [<i>].party_id) != 255)
					<got_players> = 1
					getnumplayersingame \{local
						out = num_local_players}
					removeparameter \{local_primary_joining}
					if (<num_local_players> = 0)
						local_primary_joining = 1
					endif
					band_lobby_add_player_to_playerinfo player_type = party data = (<connections> [<i>]) local_primary_joining = <local_primary_joining>
					if ((<connections> [<i>].controller_index) = ($primary_controller))
						change g_leader_player_num = <playerinfo>
					endif
				endif
				i = (<i> + 1)
				repeat <array_size>
			endif
			if (<got_players> = 1)
				break
			else
				wait \{1
					second}
			endif
			repeat 60
			if (<got_players> = 0)
				<join_result> = 0
			endif
		endif
		change \{g_net_leader_player_num = -1}
		stoprendering
		destroy_loading_screen
		change \{g_net_party_needs_full_sync = 1}
		ui_event \{event = menu_change
			data = {
				state = uistate_band_lobby
			}}
	endif
	if (<join_result> = 0)
		shut_down_net_play
		changeglobalinteger \{global_name = g_net_leader_player_num
			new_value = -1}
		changeglobalinteger \{global_name = g_leader_player_num
			new_value = -1}
		netsessionfunc \{obj = party
			func = stop_party_session}
		printf \{qs(0x71dfc671)}
		if isps3
			popup_text = qs(0x366e10c6)
			if gotparam \{reason}
				if (<reason> = bad_state)
					<popup_text> = qs(0x33923e7f)
				endif
			endif
		else
			popup_text = qs(0x4e216451)
			if gotparam \{reason}
				if (<reason> = bad_state)
					<popup_text> = qs(0x3c913dd8)
				endif
			endif
		endif
		create_mainmenu_bg
		create_dialog_box {
			heading_text = qs(0x4d21d20e)
			body_text = <popup_text>
			options = [
				{
					func = net_party_failed_join_attempt_continue
					text = qs(0x182f0173)
				}
			]
		}
		destroy_loading_screen
	endif
	if (<join_result> = 1)
		dgsrecorddata_joingameinvitesuccess controller = <invite_controller>
	else
		dgsrecorddata_joingameinvitefailure controller = <invite_controller>
	endif
	change \{invite_controller = -1}
endscript

script net_party_failed_join_attempt_continue 
	destroy_mainmenu_bg
	destroy_dialog_box
	clean_up_user_control_helpers
	ui_event \{event = menu_refresh
		data = {
			lost_party
			refresh_animate
		}}
endscript

script net_party_lost_party_connection 
	printf \{qs(0xb6121789)}
	ui_event_wait_for_safe
	begin
	if NOT ui_event_exists_in_stack \{name = 'memcard'}
		break
	endif
	printf \{qs(0x778f9c7b)}
	wait \{1
		gameframe}
	repeat
	printf \{qs(0x7e3f37ad)}
	ui_event_wait_for_safe
	ui_event_get_stack
	if NOT ((<stack> [0].base_name) = 'mainmenu')
		if bl_is_in_band_lobby_menus
			wait \{1
				second}
			if bl_should_do_party_connection_lost_logic
				change g_net_leader_player_num = ($g_leader_player_num)
				change g_copy_leader_player_num = ($g_leader_player_num)
				change g_copy_net_leader_player_num = ($g_net_leader_player_num)
				change \{g_career_search = null}
				band_lobby_destroy_popup_menu
				getnumplayersingame \{remote}
				if (<num_players> > 0)
					getfirstplayer \{remote}
					begin
					net_clear_player_info player = <player>
					getnextplayer player = <player> remote
					repeat <num_players>
				endif
				band_lobby_add_in_game_players_to_party
				band_lobby_clear_all_submenu_data
				<player> = 1
				begin
				formattext checksumname = musician_value 'musician%p' p = <player>
				setplayerinfo <player> band_member = <musician_value>
				<player> = (<player> + 1)
				repeat 4
				if screenelementexists \{id = band_lobby_desc_id}
					band_lobby_desc_id :se_setprops \{block_events}
				endif
				create_net_popup \{title = qs(0x5ca2c535)
					popup_text = qs(0xc4ad8373)}
				dialog_box_container :obj_spawnscriptnow \{net_party_lost_party_connection_kill_popup}
			endif
		else
			printf \{qs(0x265573b1)}
			ui_print_states
			band_lobby_add_in_game_players_to_party
			band_lobby_set_party_joinable \{joinable = 0}
		endif
	endif
endscript

script net_party_lost_party_connection_kill_popup \{got_band_lobby_popup = 0}
	wait \{3
		seconds}
	ui_event_wait_for_safe
	ui_event_get_stack
	if ((<stack> [0].base_name) = 'connection_loss')
		return
	endif
	if screenelementexists \{id = band_lobby_desc_id}
		begin
		if NOT savegame_async_is_busy
			break
		endif
		wait \{1
			gameframe}
		repeat
		begin
		if NOT scriptisrunning \{downloads_enumcontent}
			break
		endif
		wait \{1
			gameframe}
		repeat
		ui_event_get_stack
		if ('band_lobby' = (<stack> [1].base_name))
			if structurecontains structure = (<stack> [0]) is_popup
				<got_band_lobby_popup> = 1
			endif
		endif
		ui_event \{event = menu_back
			data = {
				state = uistate_band_lobby
			}}
		begin
		ui_event_wait_for_safe
		ui_event_get_stack
		if ((<stack> [0].base_name) = 'band_lobby')
			ui_event_wait_for_safe
			break
		endif
		wait \{1
			gameframe}
		repeat
		destroy_net_popup
		if (1 = <got_band_lobby_popup>)
			ui_event \{event = menu_refresh}
		endif
		band_lobby_update_button_helpers
		if isps3
			ui_event_wait_for_safe
			<submenu_index> = 0
			begin
			band_lobby_get_submenu_data submenu_index = <submenu_index> param = menu
			band_lobby_get_submenu_data submenu_index = <submenu_index> param = occupied
			band_lobby_get_submenu_data submenu_index = <submenu_index> param = player
			if (0 = <occupied> && empty = <menu>)
				band_lobby_change_menu action = forward menu = join player = <player> submenu_index = <submenu_index> focus = 1 no_forced
			endif
			<submenu_index> = (1 + <submenu_index>)
			repeat ($g_num_lobby_local_submenus)
		endif
		return
	endif
	destroy_net_popup
endscript

script net_party_receive_host_party_info 
	printf \{qs(0x3529c519)}
endscript

script net_party_handle_host_migration 
	printf \{qs(0xe3b5f2c3)}
	printstruct <...>
	if checksumequals a = <result> b = success
		printf \{qs(0x9f63d52c)}
	elseif checksumequals a = <result> b = failed
		printf \{qs(0xff917b1d)}
	elseif checksumequals a = <result> b = started
		printf \{qs(0xe4b8150d)}
	else
		printf \{qs(0x6c4e4835)}
	endif
endscript

script net_party_add_player_late_result 
	printf \{qs(0x837240cf)}
	printstruct <...>
	if bl_is_in_band_lobby_menus
		band_lobby_wait_for_menu_update submenu_index = <controller_index>
		if (<join_result> = 1)
			getplayerinfo (<controller_index> + 1) in_game
			getplayerinfo (<controller_index> + 1) is_local_client
			if ((<in_game> = 0) || (<in_game> = 1 && <is_local_client> = 0))
				band_lobby_join submenu_index = <controller_index> device_num = <controller_index>
			endif
		else
			band_lobby_failed_join controller = <controller_index>
		endif
	endif
endscript

script net_party_debug_dump 
	printf \{qs(0x5243db76)}
	netsessionfunc \{obj = party
		func = get_party_members}
	printstruct <...>
endscript
